<?xml version="1.0" encoding="utf-8" standalone="yes"?>
<rss version="2.0" xmlns:atom="http://www.w3.org/2005/Atom">
  <channel>
    <title>mistake on 记得</title>
    <link>https://www.syst.top/tags/mistake/</link>
    <description>Recent content in mistake on 记得</description>
    <generator>Hugo -- gohugo.io</generator>
    <language>zh-hans</language>
    <copyright>This work is licensed under a Creative Commons Attribution-NonCommercial 4.0 International License.</copyright>
    <lastBuildDate>Wed, 21 Apr 2021 23:54:52 +0800</lastBuildDate><atom:link href="https://www.syst.top/tags/mistake/index.xml" rel="self" type="application/rss+xml" />
    <item>
      <title>在Go中高频犯过的错 </title>
      <link>https://www.syst.top/posts/go/mistake/</link>
      <pubDate>Wed, 21 Apr 2021 23:54:52 +0800</pubDate>
      
      <guid>https://www.syst.top/posts/go/mistake/</guid>
      <description>在迭代器变量上使用goroutine 我们来看一段代码
package main import ( &amp;#34;fmt&amp;#34; &amp;#34;sync&amp;#34; ) type User struct { userId int } func main() { var userList []User for i := 0; i &amp;lt; 10; i++ { userList = append(userList, User{userId: i}) } var wg sync.WaitGroup for i, _ := range userList { wg.Add(1) go func() { defer wg.Done() Do(userList[i]) }() } wg.Wait() } func Do(user User) { fmt.Printf(&amp;#34;用户id:%v\n&amp;#34;, user.userId) } 一个很简单的利用 sync.waitGroup 做任务编排的场景，看一下好像没啥问题，运行看看结果。
啥情况，为啥不是1-9(当然不是顺序的)。
原因很简单，循环器中的 i 实际上是一个单变量，go func 里的闭包只绑定在一个变量上， 每个 goroutine 可能要等到循环结束才真正的运行，这时候运行的 i 值大概率就是 9了。 大概率的意思是没人能保证这个过程，有的只是手段。</description>
    </item>
    
  </channel>
</rss>
